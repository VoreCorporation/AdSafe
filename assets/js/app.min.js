/*!
  * Auth App v1.0.0 (https://www.vorecorp.id)
  * Copyright 2018 Vore Corporation
  * Licensed under MIT
  */
function get_ip(){$.getJSON("//api.ipify.org?format=jsonp&callback=?",function(t){return t.ip})}function dec2hex(t){return(t<15.5?"0":"")+Math.round(t).toString(16)}function hex2dec(t){return parseInt(t,16)}function base32tohex(t){for(var e="",n="",r=0;r<t.length;r++){e+=leftpad("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(t.charAt(r).toUpperCase()).toString(2),5,"0")}for(r=0;r+4<=e.length;r+=4){var i=e.substr(r,4);n+=parseInt(i,2).toString(16)}return n}function leftpad(t,e,n){return e+1>=t.length&&(t=Array(e+1-t.length).join(n)+t),t}function checkOtp(t,e){var n=base32tohex(e),r=Math.round((new Date).getTime()/1e3),i=leftpad(dec2hex(Math.floor(r/30)),16,"0"),o=new jsSHA("SHA-1","HEX");o.setHMACKey(n,"HEX"),o.update(i);var c=o.getHMAC("HEX"),a=0;"KEY MUST BE IN BYTE INCREMENTS"!==c&&(a=hex2dec(c.substring(c.length-1)));var s="https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=200x200&chld=M|0&cht=qr&chl=otpauth://totp/"+t+"%3Fsecret%3D"+e,h=(hex2dec(c.substr(2*a,8))&hex2dec("7fffffff"))+"";return[{qrcode:s,otpcode:h=h.substr(h.length-6,6)}]}var Twofactor=Class({constructor:function(t,e){this.account=t,this.secretkey=e},getotp:function(){return checkOtp(this.account,this.secretkey)[0].otpcode},getqr:function(){return checkOtp(this.account,this.secretkey)[0].qrcode}}),Session=Class({constructor:function(t){this.name=t},data:{get:function(){return this._data},set:function(t){this._data=t}},days:{get:function(){return this._days},set:function(t){this._days=t}},create:function(){var t=this,e="";if(void 0!=t.days){var n=new Date;n.setTime(n.getTime()+24*t.days*60*60*1e3),e="; expires="+n.toUTCString()}document.cookie=t.name+"="+t.data+e+"; path=/"},check:function(){for(var t=this.name+"=",e=document.cookie.split(";"),n=0;n<e.length;n++){for(var r=e[n];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null},clear:function(){var t=this;t.data="",t.days=-1,t.create(),window.location="/"}}),Auth=Class({constructor:function(t,e){this.client=t,this.auth=e},member:function(){var t=get_ip(),e=md5(this.client+"_"+t);if(this.auth==e)return!0;window.location="/p/login.html"},public:function(){var t=get_ip(),e=md5(this.client+"_"+t);if(this.auth!=e)return!0;window.location="/"}}),Parameter=Class({constructor:function(t){this.param=t},get:function(){for(var t=window.location.search.substr(1).split("&"),e=0;e<t.length;e++){var n=t[e].split("=");if(n[0]==this.param)return decodeURIComponent(n[1])}return!1}});